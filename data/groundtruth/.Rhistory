for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
print(paste(j,abcd[2],time,sep=" "))
if (!("FALSE" %in% as.list(abcd>0))){
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
alg2 <- function(){
for (i in 1:length(times)){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
#print(paste(j,abcd[2],time,sep=" "))
if (!("FALSE" %in% as.list(abcd>0))){
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
alg2 <- function(){
for (i in 1:length(times)){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[2],time,sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
alg2()
times
times <- seq(0.1,5,by=0.1)
alg2 <- function(){
for (i in 1:length(times)){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[2],tD,sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
times <- seq(0.1,5,by=0.1)
td <- 0.2
player <- 5
temp <- subset(df, id == player)
A <- rep(list(rep(list(matrix(0,nrow=70,ncol=107)),30)),length(times))
indices <- function(p,vt,tD){
return(c(floor(p[1]+53.5),floor(p[2]+35),vt,which(tD == times)))
}
alg2 <- function(){
for (i in 1:1){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[2],tD,sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
list[1][[1]]
A[1][[1]]
A[1][[1]]->B
B
table(B)
which(times[[1]] == times)
alg2 <- function(){
for (i in 1:1){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[2],tD,sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
alg2 <- function(){
for (i in 1:1){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[2],abcd[4],sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
alg2 <- function(){
for (i in 1:1){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
A[1][[1]][1][[1]][16,40]
A[1][[1]][1][[1]][16,40]<-A[1][[1]][1][[1]][16,40]+1
A[1][[1]][1][[1]][16,40]
abcd
abcd <- c(16,40,1,1)
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
A[1][[1]][1][[1]][16,40]
A <- rep(list(rep(list(matrix(0,nrow=70,ncol=107)),30)),length(times))
indices <- function(p,vt,tD){
return(c(floor(p[1]+53.5),floor(p[2]+35),vt,which(tD == times)))
}
alg2 <- function(){
for (i in 1:1){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
A[1][[1]][1][[1]][16,40]
A[1][[1]][1][[1]][22,28]
alg2 <- function(){
for (i in 1:1){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] = A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
A[1][[1]][1][[1]][22,28]
alg2 <- function(){
for (i in 1:1){#
tD = times[[i]]
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] <- A[abcd[4]][[1]][abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
}
alg2()
A[1][[1]][1][[1]][22,28]
A[1][[1]][1][[1]][28,22]
B<-list(rep(list(matrix(0,nrow=70,ncol=107)),30))
B[1]
B[1][[1]]
C<_B[1][[1]]
C<-B[1][[1]]
C[1,1]
B<-rep(list(matrix(0,nrow=70,ncol=107)),30)
B[1][[1]]
C<-B[1][[1]]
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[1],abcd[2]] <- B[abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
return(B)
}
B<-alg2(0.1)
c<-B[1][[1]]
C<-B[1][[1]]
c
C
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[1],abcd[2]] <- B[abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
return(B)
}
debug(alg2)
B<-alg2(0.1)
abcd
B[1][[1]][49,25]
B[1][[1]][49,25]
C<-B[1][[1]]
View(C)
table(data.frame(C))
B[1][[1]]
nnzero(B[1][[1]])
colSums(B[1][[1]] != 0)
B[1][[1]]
colSums(B[1][[1]])
plot(colSums(B[1][[1]]))
hist(colSums(B[1][[1]]))
plot(colSums(B[1][[1]]))
plot(rowSums(B[1][[1]]))
plot(colSums(B[1][[1]]))
plot(rowSums(B[1][[1]]))
plot(rowSums(B[2][[1]]))
plot(rowSums(B[3][[1]]))
plot(rowSums(B[4][[1]]))
for (i in 1:length(times)){
A[i]<-alg2(times[i])
}
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0))){
#print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[1],abcd[2]] <- B[abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
return(B)
}
for (i in 1:length(times)){
print(i)
A[i]<-alg2(times[i])
}
B<-alg2(0.1)
B<-alg2(0.2)
debug(alg2)
B<-alg2(0.2)
which(0.2 == times)
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0)) && abcd[1] <=107 && abcd[2] <=70){
#print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[1],abcd[2]] <- B[abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
return(B)
}
B<-alg2(0.2)
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0)) && abcd[1] <=107 && abcd[2] <=70){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[1],abcd[2]] <- B[abcd[3]][[1]][abcd[1],abcd[2]] + 1
}
}
}
return(B)
}
B<-alg2(0.2)
B[2][[1]]
B<-alg2(0.2)
B[2][[1]][71,28]
dim(B[2][[1]])
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0)) && abcd[1] <=107 && abcd[2] <=70){
print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[2],abcd[1]] <- B[abcd[3]][[1]][abcd[2],abcd[1]] + 1
}
}
}
return(B)
}
B<-alg2(0.2)
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0)) && abcd[1] <=107 && abcd[2] <=70){
#print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[2],abcd[1]] <- B[abcd[3]][[1]][abcd[2],abcd[1]] + 1
}
}
}
return(B)
}
times <- seq(0.1,5,by=0.1)
td <- 0.2
player <- 5
temp <- subset(df, id == player)
A <- list()
indices <- function(p,vt,tD){
return(c(floor(p[1]+53.5),floor(p[2]+35),vt,which(tD == times)))
}
alg2 <- function(tD){
B <- rep(list(matrix(0,nrow=70,ncol=107)),30)
for (i in 1:1){
for (j in 3:nrow(temp)){
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p <- transform(ps,pt,pu)
vt <- as.numeric(df[j,9])
abcd <- indices(p,vt,tD)
if (!("FALSE" %in% as.list(abcd>0)) && abcd[1] <=107 && abcd[2] <=70){
#print(paste(j,abcd[1],abcd[2],abcd[3],abcd[4],sep=" "))
B[abcd[3]][[1]][abcd[2],abcd[1]] <- B[abcd[3]][[1]][abcd[2],abcd[1]] + 1
}
}
}
return(B)
}
for (i in 1:length(times)){
print(i)
A[i]<-alg2(times[i])
}
warnings()
A[i]
colSums(A[i]
)
colSums(A[i][[1]])
for (i in 1:length(times)){
print(i)
A[i][[1]]<-alg2(times[i])
}
for (i in 1:length(times)){
print(i)
A[i][[1]]<-alg2(times[i])
}
probP <- function(tD,ps,pt,p,v){
abcd <- indices(transform(ps,pt,p),v,tD)
return((A[abcd[4]][[1]][3][[1]][abcd[2],abcd[1]])/(sum(colSums(A[abcd[4]][[1]][3][[1]]))))
}
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
pu <- c(df[(j+gap),4],df[(j+gap),5])
probP(tD,ps,pt,pu,0.5)
A[abcd[4]][[1]][3][[1]]
class(A[abcd[4]][[1]][3][[1]])
colSums(A[abcd[4]][[1]][3][[1]])
probP(tD,ps,pt,pu,0.5)
probP <- function(tD,ps,pt,p,v){
abcd <- indices(transform(ps,pt,p),v,tD)
return((A[abcd[4]][[1]][abcd[3]][[1]][abcd[2],abcd[1]])/(sum(colSums(A[abcd[4]][[1]][abcd[3]][[1]]))))
}
probP(tD,ps,pt,pu,0.5)
abcd <- indices(transform(ps,pt,pu),0.5,tD)
abcd
abcd <- indices(transform(ps,pt,pu),0.6)
abcd <- indices(transform(ps,pt,pu),0.6,tD)
probP(tD,ps,pt,pu,0.6)
abcd
which(tD==times)
tD=0.6
pt <- c(df[(j),4],df[(j),5])
ps <- c(df[(j-2),4],df[(j-2),5])
gap <- tD/0.1
pu <- c(df[(j+gap),4],df[(j+gap),5])
p<-transform(ps,pt,pu)
abcd <- indices(transform(ps,pt,pu),0.5,tD)
probP(tD,ps,pt,pu,0.6)
abcd
abcd <- indices(transform(ps,pt,pu),03,tD)
abcd <- indices(transform(ps,pt,pu),3,tD)
probP(tD,ps,pt,pu,3)
probP(tD,ps,pt,pu,4)
probP(tD,ps,pt,pu,2)
probP(tD,ps,pt,pu,1)
probP(tD,ps,pt,pu,5)
probP(tD,ps,pt,pu,6)
