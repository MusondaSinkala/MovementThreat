group_by(team)%>%
nest() %>%
mutate(
hull = map(data, ~ with(.x, chull(x.mean, y.mean))),
out = map2(data, hull, ~ .x[.y,,drop=FALSE])
)%>%
select(-data)%>%
unnest()
data_hull <- pos %>%
filter(!(id %in% c(1,2,13))) %>%
group_by(team)%>%
nest() %>%
mutate(
hull = map(data, ~ with(.x, chull(x.mean, y.mean))),
out = map2(data, hull, ~ .x[.y,,drop=FALSE])
)%>%
select(-data)%>%
unnest()
pos <- df %>%
group_by(team, id) %>%
dplyr::summarise(x.mean = mean(x), y.mean = mean(y)) %>%
ungroup() %>%
mutate(team = as.factor(team), id = as.factor(id)) %>%
as.data.frame()
data_hull <- pos %>%
filter(!(id %in% c(1,2,13))) %>%
group_by(team)%>%
nest() %>%
mutate(
hull = map(data, ~ with(.x, chull(x.mean, y.mean))),
out = map2(data, hull, ~ .x[.y,,drop=FALSE])
)%>%
select(-data)%>%
unnest()
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x, y, frame = .frame), fill = 'red', alpha = 0.4) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x, y, frame = .frame), fill = 'blue', alpha = 0.4) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
data_hull
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean, y.mean), fill = 'red', alpha = 0.4) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean, y.mean), fill = 'blue', alpha = 0.4) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35), fill = 'red', alpha = 0.4) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35), fill = 'blue', alpha = 0.4) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
data_hull <- pos %>%
filter(!(id %in% c(2,13))) %>%
group_by(team)%>%
nest() %>%
mutate(
hull = map(data, ~ with(.x, chull(x.mean, y.mean))),
out = map2(data, hull, ~ .x[.y,,drop=FALSE])
)%>%
select(-data)%>%
unnest()
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35), fill = 'red', alpha = 0.4) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35), fill = 'blue', alpha = 0.4) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35), alpha = 0.4) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35), alpha = 0.4) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35), alpha = 0.9) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35), alpha = 0.9) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
pal
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35),fill=pal[3], alpha = 0.5) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35),fill=pal[1] alpha = 0.5) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35),fill=pal[3], alpha = 0.5) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35),fill=pal[1], alpha = 0.5) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35),fill=pal[3], alpha = 0.2) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35),fill=pal[1], alpha = 0.2) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35),fill=pal[4], alpha = 0.2) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35),fill=pal[2], alpha = 0.2) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
ggplot()+
geom_point(data = pos,
aes(x=x.mean+53.5,y=y.mean+35,colour=team),
size=3,alpha=1)+
geom_point(data = cent,
aes(x=centX+53.5,y=centY+35,colour=team,fill=team),
size=5)+
geom_polygon(data = filter(data_hull, team == 'h'), aes(x.mean+53.5, y.mean+35),fill=pal[4], alpha = 0.35) +
geom_polygon(data = filter(data_hull, team == 'a'), aes(x.mean+53.5, y.mean+35),fill=pal[2], alpha = 0.35) +
#perimeter
geom_rect(aes(xmax=107,xmin=0,ymax=70,ymin=0),fill=NA,color="grey")+
# centre circle
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 9.15), col = colPitch, lwd = lwd) +
# kick off spot
geom_circle(aes(x0 = lengthPitch/2, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# halfway line
geom_segment(aes(x = lengthPitch/2, y = 0, xend = lengthPitch/2, yend = widthPitch), col = colPitch, lwd = lwd) +
# penalty arcs
geom_arc(aes(x0= 11, y0 = widthPitch/2, r = 9.15, start = pi/2 + 0.9259284, end = pi/2 - 0.9259284), col = colPitch, lwd = lwd) +
geom_arc(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 9.15, start = pi/2*3 - 0.9259284, end = pi/2*3 + 0.9259284), col = colPitch, lwd = lwd) +
# penalty areas
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 16.5, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 16.5, xmax = lengthPitch, ymin = widthPitch/2 - 20.15, ymax = widthPitch/2 + 20.15), fill = NA, col = colPitch, lwd = lwd) +
# penalty spots
geom_circle(aes(x0 = 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
geom_circle(aes(x0 = lengthPitch - 11, y0 = widthPitch/2, r = 0.25), fill = colPitch, col = colPitch, lwd = lwd) +
# six yard boxes
geom_rect(aes(x=NULL,y=NULL,xmin = 0, xmax = 5.5, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch - 5.5, xmax = lengthPitch, ymin = (widthPitch/2) - 9.16, ymax = (widthPitch/2) + 9.16), fill = NA, col = colPitch, lwd = lwd) +
# goals
geom_rect(aes(x=NULL,y=NULL,xmin = -2, xmax = 0, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd) +
geom_rect(aes(x=NULL,y=NULL,xmin = lengthPitch, xmax = lengthPitch + 2, ymin = (widthPitch/2) - 3.66, ymax = (widthPitch/2) + 3.66), fill = NA, col = colPitch, lwd = lwd)+
coord_fixed()+
scale_color_manual(values=pal[c(1,5,3)])+
scale_x_continuous(breaks = seq(-200,-180,by=10)) +
scale_y_continuous(breaks = seq(-200,-180,by=10)) +
fte_theme(font = c("Segoe UI Light","Segoe UI"))+
theme(panel.background=element_rect(fill=green, color=green)) +
theme(plot.background=element_rect(fill=green, color=green)) +
theme(panel.border=element_rect(color=green)) +
labs(title="Average Positions",x="",y="")
?geom_hline
head(df)
wDF <- df[,c(2,2,4,5)]
wDF
write.table
()
write.table(wDF,"small.txt",sep=";")
write.table(wDF,"small.txt",sep=";",row.names = F)
wDF <- df[,c(2,2,1,4,5)]
write.table(wDF,"small.txt",sep=";",row.names = F)
wDF$id.1<-as.numeric(wDF$id.1)
wDF$id<-as.numeric(wDF$id)
wDF$frame<-as.numeric(wDF$frame)
write.table(wDF,"small.txt",sep=";",row.names = F)
write.table(wDF,"small.txt",sep=";",row.names = F,col.names=F)
